<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我们的爱情日记</title>
    <style>
        :root {
            --primary: #FFB7C5;
            --secondary: #89C4F4;
            --text: #4A4A4A;
        }

        /* 基础样式 */
        body {
            font-family: 'Microsoft Yahei', sans-serif;
            margin: 0;
            background: #f8f9fa;
        }

        /* 导航栏 */
        .nav-bar {
            display: flex;
            background: white;
            padding: 1rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .nav-btn {
            padding: 0.8rem 1.5rem;
            margin: 0 1rem;
            border: none;
            background: none;
            cursor: pointer;
            transition: all 0.3s;
        }

        .nav-btn.active {
            border-bottom: 3px solid var(--primary);
        }

        /* 界面容器 */
        .page {
            display: none;
            padding: 2rem;
        }

        .page.active {
            display: block;
        }

        /* 首页轮播图 */
        .carousel {
            height: 400px;
            position: relative;
            overflow: hidden;
            border-radius: 15px;
        }

        .carousel-inner {
            display: flex;
            transition: transform 0.5s;
        }

        .carousel-item {
            min-width: 100%;
            height: 400px;
            background-size: cover;
            background-position: center;
        }

        /* 倒计时样式 */
        .countdown-box {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            margin: 2rem 0;
            text-align: center;
        }

        /* 笔记本界面 */
        .notebook-container {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 2rem;
            height: 80vh;
        }

        .note-list {
            background: white;
            padding: 1rem;
            border-radius: 12px;
            overflow-y: auto;
        }

        .note-editor {
            background: white;
            padding: 2rem;
            border-radius: 12px;
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="nav-bar">
        <button class="nav-btn active" data-page="home">首页</button>
        <button class="nav-btn" data-page="gallery">照片墙</button>
    </nav>

    <!-- 首页 -->
    <section id="home" class="page active">
        <!-- 轮播图 -->
        <div class="carousel">
            <div class="carousel-inner" id="carouselInner"></div>
        </div>

        <!-- 倒计时 -->
        <div class="countdown-box">
            <h2>距离我们第 <span id="anniversaryYear">5</span> 周年还有</h2>
            <div id="countdown" class="display-4"></div>
        </div>

        <!-- 笔记本入口 -->
        <button onclick="showNotebook()" class="btn-primary">打开恋爱笔记本</button>
    </section>

    <!-- 照片墙 (之前版本代码) -->
    <section id="gallery" class="page">
        <!-- 照片墙内容 -->
    </section>

    <!-- 笔记本界面 -->
    <section id="notebook" class="page">
        <div class="notebook-container">
            <div class="note-list" id="noteList"></div>
            <div class="note-editor">
                <input type="text" id="noteTitle" placeholder="输入标题">
                <textarea id="noteContent" rows="15"></textarea>
                <button onclick="saveNote()">保存笔记</button>
            </div>
        </div>
    </section>

    <script>
        // 全局状态
        let currentPage = 'home';
        let anniversaryYear = 5;
        const LOVE_START = new Date('2020-10-16');

        // 初始化
        initCarousel();
        updateCountdown();
        loadNotes();

        // 导航切换
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                currentPage = btn.dataset.page;
                document.querySelectorAll('.page').forEach(p => 
                    p.classList.remove('active')
                );
                document.getElementById(currentPage).classList.add('active');
            });
        });

        // 轮播图初始化
        function initCarousel() {
            const photos = JSON.parse(localStorage.getItem('gallery') || '[]');
            const carousel = document.getElementById('carouselInner');
            
            photos.forEach(photo => {
                const item = document.createElement('div');
                item.className = 'carousel-item';
                item.style.backgroundImage = `url(${photo})`;
                carousel.appendChild(item);
            });

            // 自动轮播
            let current = 0;
            setInterval(() => {
                current = (current + 1) % photos.length;
                carousel.style.transform = `translateX(-${current * 100}%)`;
            }, 5000);
        }

        // 倒计时逻辑
        function updateCountdown() {
            const targetYear = LOVE_START.getFullYear() + anniversaryYear;
            let targetDate = new Date(LOVE_START);
            targetDate.setFullYear(targetYear);

            // 如果今年纪念日已过，指向下一年
            if(new Date() > targetDate) {
                anniversaryYear++;
                targetDate.setFullYear(targetYear + 1);
            }

            const diff = targetDate - new Date();
            const days = Math.ceil(diff / (1000 * 3600 * 24));

            document.getElementById('countdown').textContent = `${days} 天`;
            document.getElementById('anniversaryYear').textContent = anniversaryYear;

            setTimeout(updateCountdown, 1000);
        }

        // 笔记本功能
        function showNotebook() {
            currentPage = 'notebook';
            document.getElementById('notebook').classList.add('active');
        }

        function saveNote() {
            const notes = JSON.parse(localStorage.getItem('notes') || '[]');
            const newNote = {
                id: Date.now(),
                title: document.getElementById('noteTitle').value,
                content: document.getElementById('noteContent').value,
                date: new Date().toISOString()
            };
            
            notes.push(newNote);
            localStorage.setItem('notes', JSON.stringify(notes));
            loadNotes();
        }

        function loadNotes() {
            const notes = JSON.parse(localStorage.getItem('notes') || '[]');
            const list = document.getElementById('noteList');
            
            list.innerHTML = notes.map(note => `
                <div class="note-item" onclick="showNoteDetail(${note.id})">
                    <h4>${note.title}</h4>
                    <small>${new Date(note.date).toLocaleDateString()}</small>
                </div>
            `).join('');
        }

        function showNoteDetail(id) {
            const notes = JSON.parse(localStorage.getItem('notes') || '[]');
            const note = notes.find(n => n.id === id);
            
            document.getElementById('noteTitle').value = note.title;
            document.getElementById('noteContent').value = note.content;
        }
    </script>
</body>
</html>
